<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SOS Emergency | CampusSafe</title>
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>

  <!-- NAVBAR -->
  <header class="navbar">
    <div class="logo">
      <span class="logo-icon">ðŸ›¡</span>
      <span>CampusSafe</span>
    </div>

    <nav>
      <a href="homepage.html">Home</a>
      <a href="dashboard.html">Support</a>
      <a href="profile.html">Profile</a>
    </nav>
  </header>

  <!-- SOS CENTERED PAGE -->
  <div class="sos-page">
    <div class="sos-card">

      <h2>ðŸš¨ Emergency SOS</h2>
      <p class="subtitle">
        Press the button below to alert campus security immediately
      </p>

      <!-- ONE TAP SOS -->
      <button id="sosBtn">SOS</button>

      <hr />

      <!-- VOICE / TEXT DEMO -->
      <div class="voice-box">
        <h3>Voice / Text Emergency (Demo)</h3>

        <div class="voice-demo">
          <input
            type="text"
            id="emergencyInput"
            placeholder="Type emergency message"
          />

          <!-- MIC BUTTON -->
          <button id="micBtn" class="mic-btn" title="Speak emergency">
            ðŸŽ¤
          </button>

          <!-- SEND BUTTON -->
          <button id="sendBtn" class="btn primary">Send</button>
        </div>
      </div>

    </div>
  </div>

  <!-- JS -->
  <script type="module">
    import { triggerSOS } from "./js/utils.js";

    // One-tap SOS button
    document.getElementById("sosBtn").addEventListener("click", () => {
      triggerSOS();
    });

    // Text-based emergency detection (demo)
    document.getElementById("sendBtn").addEventListener("click", () => {
      const text = document.getElementById("emergencyInput").value.toLowerCase();

      const keywords = ["help", "sos", "emergency", "danger", "unsafe"];

      const isEmergency = keywords.some(word => text.includes(word));

      if (isEmergency) {
        triggerSOS();
      } else {
        alert("No emergency detected");
      }
    });

    // Mic button â†’ Dialogflow Voice Assistant
    document.getElementById("micBtn").addEventListener("click", () => {
      window.open(
        "https://console.dialogflow.com/api-client/demo/embedded/6c6cce23-0d9e-4d0e-8f3d-ae81defd3963",
        "_blank"
      );
    });
  </script>

</body>
</html>
